Laba-processes

## Lab-process


**1. Дисковые устройства и партиции**

Диск sda имеет размер 8 GB.

![8ea146a69532c4473e23982f710376a6.png](../images/1a218004258b465d9e5947af8b3bcc2d.png)
*****************************************************************
Размер партиций: 476 MB (500 MB) и 7.5 GB. В корень смонтирована партиция sda2.

![a8565abd47a21787c1fd5dec3eb9f799.png](../images/f415607ef588454690b20b49c63bb7f9.png)
*****************************************************************
Идентификаторы партиций. 

![56486eabf8e8caf2bb48f66d159da776.png](../images/8937aefb67fc49a890dda95b18cf35c1.png)
*****************************************************************

![fa85351fd53d9981810173722fb9905e.png](../images/7085a78703f441d2abbaba94a041464a.png)
*****************************************************************
Таблица партиционирования - msdos. 

![e4271a91692e6e9cf808ad7669647acc.png](../images/b794765d9cfd4eb1a0b4432516e66771.png)
*****************************************************************
**3. Создание сжатой файловой системы для чтения squashfs**

![4d74197c28e65b0814e42eb9aa62da5c.png](../images/e34a5d2fafd14db58caee6b3aeca3bd0.png)
*****************************************************************

![adee140bf904047ec459b8eeaaeb2fab.png](../images/486540cb29f04f3ab888bac5b99e70c2.png)

**4. Информация по файловым системам, смонтированным в системе**

В корень смонтирована файловая система /dev/sda2. Примонтированная файловая система в /mnt/mai - /dev/loop0. Ее размер - 128 КБ.

![40d57795ba9158ae78f016d59985726b.png](../images/0830efd55074461da9ad1b6206353004.png)
*****************************************************************

![9551fb05fc7c4345ce59a71ce49a8878.png](../images/7e7230cddf8444008f7f91554396b32f.png)
*****************************************************************
Опции - rw, relatime, errors=remount-ro.

![0b9e66282692c4378dfbb707ea20a79c.png](../images/cc3be911c2f34d48950cedc81258bc4c.png)

**5. Создание файла в каталоге /dev/shm**

![aebe336776bb90184f0282f907b81d95.png](../images/3d866fca34084a728259235c2da8f69b.png)
*****************************************************************
До удаления /dev/shm/mai.

![f77232d82df8c048ff7ee878616ba7d7.png](../images/8e93a1e1622540e7be517ef3d9f36d21.png)
*****************************************************************
После удаления /dev/shm/mai.
Изменялось кол-во использованной, свободной и доступной памяти.

![231a27523d422d23f7b728320f5357aa.png](../images/c17e9934c8484106b8a37d2a1d17a92d.png)

**6. Изучение процессов, запущенных в системе**

Процессы, порождающие дочерние процессы: systemd, gnome, gdm3, php-fpm.
Мультитредовые процессы: gnome, gdm3. 

![e447705bc44964328ee432dfcc3daabf.png](../images/418858e54c474e87a256a074db7828f8.png)
*****************************************************************

![3b7ae4a83f9e744bac027cf8311964b8.png](../images/4c60768d84f045d991e40f0eadc52a19.png)
*****************************************************************

![d26819322804f87dcf726324ec75c387.png](../images/01d24cb5284a49f48eda8cb75df6da4b.png)
*****************************************************************

![f204a448e19af75480f12312f4f3e9b0.png](../images/d58131035adc40a09c9c70dc43367f66.png)
*****************************************************************

![cc7d0efa97f1103e8d2631234c70f902.png](../images/0115d9f8c1374c75b74ebd2d25c08b8c.png)

**7. Что делает команда**

![fec3b44e22d00bd62804957902e63e3a.png](../images/1f09c6f087c0425ca4648ae59a13c200.png)
Команда выдает в килобайтах количество свободной оперативной памяти, использованной всеми пользователями. 

![43bee5293c6227d9be6eaa05d45e4d0c.png](../images/93a9631623494a62a4c159ece0817347.png)

**8. Утилита smem, параметр PSS**

Доля, занимаемая процессом в общей памяти.

![387c28652b681d856a82c068b8520f68.png](../images/0820c58ae9624f7eafdddae2f4f05d6a.png)

**9. Запуск приложенного скрипта**
PID родительского процесса - 4582. 

![9a35dfe4bb8c337d9082ea91ec11f340.png](../images/298d5bc764474fb79d19264fe6bb42f9.png)
**************************************************************************
На скриншоте видно, что полно зомби-процессов. Это происходит из-за того, что дочерние процессы завершаются раньше, чем родительские. После команды kiil у первого дочернего процесса PID 4583.
Скрипт создает дочерние процессы и отправляет их в сон.

![f21f5efebc846f2b3be574cdcd3e874d.png](../images/252d2e4de95c409aaa5cd5bf313c23dd.png)
**************************************************************************

**10. Корректное завершение зомби-процессов**

![06c9eb2a07751950277ca93d4efb193c.png](../images/fcea71c455ab4adb99d538111f624c8a.png)
**************************************************************************

![092fb17ab1929402d9239e8a872fa9e7.png](../images/607f47b6b5544898806852700232ec78.png)
**************************************************************************

![b5052e729a63de255da996ceddbdc4c6.png](../images/76fa3e317d674ad0b9a04a8b930120cc.png)

**11. Завершение зомби-процессов**

![bae2f3fdc33c2b2cb4233dd7a7e49de6.png](../images/353acfa88ac74d63b43d5d0aafc7dda3.png)

**12. Отмонтирование директории**

![c0ce31670742c2615a74ec9739156fbb.png](../images/c126490737554e1fbda339ba858cf502.png)
**************************************************************************

Мешает процесс с PID 5533.

![dd1c82203d4bff3f1b1ed7b13fadc76b.png](../images/33309a572162434baf1b3e5afcafd264.png)
**************************************************************************
Директория размонтирована успешно.

![0b092e699bc6b7ddd9b0ea853bbb5e8c.png](../images/76d3637a63904cb58375de20194106a1.png)

**13. Исчезновение места на диске**

![5610a981505218060094443dd73838c8.png](../images/b0220ff32480443da0f05bd1a10f9a18.png)
**************************************************************************

![c73431efd861254cbe296e5295296287.png](../images/f0acd34fb4744bf6ad0ba49496a8eaf7.png)
**************************************************************************
После удаления все остается без изменений.

![d5e5b717f7642a244290008f61eca8da.png](../images/d418ea4d973d4569b3fc0be605bad500.png)
**************************************************************************
По итогу, удаление файла произошло после закрытия файлового десриптора.

**14. Утилиты наблюдения**

![99399ae70ea79b497472f426668bca30.png](../images/5a3ac926ece4491ab73c6550d1843390.png)
**************************************************************************

![91e946fa831684e1f041908e92ef9737.png](../images/8c0f4420b2814f6da1fb09730e75beb1.png)
**************************************************************************

![3ea1d156405f74c82cfc0818ab2c7597.png](../images/654743f1f54e462fae6288a84f0535f3.png)




