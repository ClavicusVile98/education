Laba-AAA.md

## Lab-AAA

**Создание пользователей**

![1.png](../_resources/1.png)

UID user1 1001
UID user2 1002
Опция -s регистрационная оболочка пользователя.
Опция -m позволяет создать домашний каталог для пользователя.

**Создание группы и добавление в неё пользователей**

Добавление пользователей в группу, а затем указание основной группы (admins) для пользователя user1 и второстепенной для user2.

![2.png](../_resources/2.png)

**Создание каталога и распределение прав**

![3.png](../_resources/3.png)

С помощью команды chmod 770 даётся разрешение на взаимодействие с директорией и/или файлом. В данном случае, мы даём все права владельцу файла и группе, но не разрешаем ничего для остальных пользователей.

![4.png](../_resources/4.png)

Созданные файлы в указанной директории.

![5.png](../_resources/5.png)

У user1 указана основная группа admins, у user2 основная группы user2. Как только мы изменим группу user2 на admins у user2 и создадим новый файл, то уже будет указана группа admins.

![6.png](../_resources/6.png)

**Создание user3 и выдача прав на написание в /opt/upload**

Создание пользователя user3. Получение ACL.

![7.png](../_resources/7.png)

При попытке создать файл в директории /opt/upload с пользователя user3, появляется ошибка.

![8.png](../_resources/8.png)

Добавление прав на запись в директорию из-под пользователя user3.

![9.png](../_resources/9.png)

![10.png](../_resources/10.png)

**Установка GUID флага на директорию /opt/upload**

Почему изменилась группа?

![11.png](../_resources/11.png)

**Установка SUID флага на выполянемый файл**
При попытки прочитать файл /etc/shadow под пользователем user3 появляется ощибка "Отказано в доступе". Как только , то на экране выводится содержимое файла.

![12.png](../_resources/12.png)

![13.png](../_resources/13.png)

![14.png](../_resources/14.png)

**Смена владельца директории /opt/upload на пользователя user3 и установка sticky-бит**

Файлы удаляются только владельцем директории или владельцем файла и никем больше. Владелец директории у нас user3. Владелец файла user1.

![15.png](../_resources/15.png)

![16.png](../_resources/16.png)

При попытке удалить файл, созданный user1, пользователем user1, операция успешно выполняется и никаких ошибок не возникает. Если зайти с пользователя user2 и удалить файл, созданный user1, то возникнет ошибка, так как user2 не является владельцем файла. Sticky-бит позволяет удалять файлы только непосредственно их владельцам. 

На скриншоте показано, как файл, созданный user2, не удаляется при вызове команды *rm -f /opt/upload/test2_1_1.sh* под пользователем user1.

![17.png](../_resources/17.png)

**Запись в sudoers**



???


