Laba-AAA.md

## Lab-AAA

**Создание пользователей**

![1.png](1.png)

UID user1 1001
UID user2 1002
Опция -s регистрационная оболочка пользователя.
Опция -m позволяет создать домашний каталог для пользователя.

**Создание группы и добавление в неё пользователей**

Добавление пользователей в группу, а затем указание основной группы (admins) для пользователя user1 и второстепенной для user2.

![24b58beb03ba4cf4ff7d10c2b7dde7f5.png](../_resources/ce2463be777b462682f180a51e0547df.png)

**Создание каталога и распределение прав**

![933a3610ebf039dd6212f64f7367487c.png](../_resources/6b5f4ef56de643b9a7a0f0dbfbc87775.png)

С помощью команды chmod 770 даётся разрешение на взаимодействие с директорией и/или файлом. В данном случае, мы даём все права владельцу файла и группе, но не разрешаем ничего для остальных пользователей.

![b9eff292f6e4899c6fdf3ef15467aa83.png](../_resources/c45ce2c92e724fc5bf6657ee7834a4a3.png)

Созданные файлы в указанной директории.

![49b6e06ba874303bd81cc772ddfe4364.png](../_resources/26409576472543b79319196654cbb790.png)

У user1 указана основная группа admins, у user2 основная группы user2. Как только мы изменим группу user2 на admins у user2 и создадим новый файл, то уже будет указана группа admins.

![9de7cc1bbb1a2699d0fb9231f58221f1.png](../_resources/3a9eb029de6c427ebeb02856511a7603.png)

**Создание user3 и выдача прав на написание в /opt/upload**

Создание пользователя user3. Получение ACL.

![63d51d1e99e29dff6bce38bd51a06409.png](../_resources/bee073aad15d4c78b20d715d8d2252d4.png)

При попытке создать файл в директории /opt/upload с пользователя user3, появляется ошибка.

![a29655e4cdc390a2d983693e971e71f8.png](../_resources/8de5902004af4c009264a4e8e4228961.png)

Добавление прав на запись в директорию из-под пользователя user3.

![63225a2aa514c027ead818f1f1a07057.png](../_resources/c6fe939c4de4448aaef540f85479a04d.png)

![14fa8e12bbef15b0de46f35da42d1a8c.png](../_resources/002043e2fffe4c159ee4ed053ffebfa6.png)

**Установка GUID флага на директорию /opt/upload**

Почему изменилась группа?

![6469db28e99b44b7c726eb274a600133.png](../_resources/95db78e0785c41f78a3e651e1f8c04c5.png)

**Установка SUID флага на выполянемый файл**
При попытки прочитать файл /etc/shadow под пользователем user3 появляется ощибка "Отказано в доступе". Как только , то на экране выводится содержимое файла.

![d561eb7c490bb974a03ade593de2578b.png](../_resources/bd15e209e6294ae99cef32566f709a27.png)

![37749616077f7f53a29ae6ece8b7fe8a.png](../_resources/382dfee0a1074239a2c81496bb80b6fe.png)

![6186470dba416aa9e131c22edb8ab730.png](../_resources/63ca326401d74cc58d6a4e2ce184e534.png)

**Смена владельца директории /opt/upload на пользователя user3 и установка sticky-бит**

Файлы удаляются только владельцем директории или владельцем файла и никем больше. Владелец директории у нас user3. Владелец файла user1.

![94ecf13feba0b60b572274b321e11caa.png](../_resources/96483c15f90747efa70a3ac3539c71e2.png)

![23b95599c99cbb831c4f985846038580.png](../_resources/b200bbe4ddae4063a0a96e25672e31cb.png)

При попытке удалить файл, созданный user1, пользователем user1, операция успешно выполняется и никаких ошибок не возникает. Если зайти с пользователя user2 и удалить файл, созданный user1, то возникнет ошибка, так как user2 не является владельцем файла. Sticky-бит позволяет удалять файлы только непосредственно их владельцам. 

На скриншоте показано, как файл, созданный user2, не удаляется при вызове команды *rm -f /opt/upload/test2_1_1.sh* под пользователем user1.

![2c2c56a2ad22f2f5f26389f8578139d3.png](../_resources/63eaf8ac4ea34d02a5b1995548f7b9f9.png)

**Запись в sudoers**



???


